import{a as j,b as u,c as g,d as ne,e as se,f as I,g as Xe,h as ae,i as ce,j as de,k as me,l as W,m as z,n as M,o as pe,p as fe,q as C,r as le,s as ue,t as ge,v as x,w as P,x as ve,y as ze}from"./chunk-BXSI4VGY.js";import"./chunk-KX3CZ4PE.js";import{D as y,E as k,G as l,H as E,I as re,J as oe,K as R,L as v,M as ye,a as X,c as Y,f as Z,g as H,i as L,k as q,l as _,q as $,r as ee,u as te,v as ie,w as K,x as D}from"./chunk-5TIJYTV6.js";import{d as Qe}from"./chunk-UJVQGVJX.js";var we=(e,i,t)=>{let{key:o,setting:a}=i,{isTemplate:r,replacers:n,node:c}=t;r||t.register(e,()=>{let m=!1,p=l(i.value,n,{t}),s=u(()=>{var f;if(m)return;let d=p();o==="href"&&!k(d).startsWith("#")&&(d=(f=R(String(d)))==null?void 0:f.toString()),q(d)?c.removeAttribute(o):c.setAttribute(o,k(d)),t.emit(a,{key:o,value:d}),window.Wized.emit("element",{id:e,element:t,setting:a,key:o,value:d})});return()=>{m=!0,g(s)}})};var Ee=(e,i,t)=>{let{setting:o}=i,{isTemplate:a,replacers:r,node:n}=t;a||t.register(e,()=>{let c=!1,m=i.class,p=l(i.condition,r,{t}),s=u(()=>{if(c)return;let d=!!p();try{n.classList.toggle(m,d)}catch(f){console.error(f)}t.emit(o,{valid:d,className:m}),window.Wized.emit("element",{id:e,element:t,setting:o,className:m,valid:d})});return()=>{c=!0,g(s)}})};var We=Qe(Xe(),1);var Ae=(e,i,t)=>{let{setting:o}=i,{name:a,isTemplate:r,node:n,replacers:c}=t;if(r||!(n instanceof HTMLFormElement))return;let m=c.map(([,p])=>p);t.register(e,()=>{let p=!1,s=l(i.value,c,{t}),d=u(()=>{if(p)return;let f=s();if(!_(f))return;ne();let w=()=>{t.emit(o,{value:f}),window.Wized.emit("element",{id:e,element:t,setting:o,value:f}),se()},A=(0,We.default)(W,["f",a,...m]);if(!_(A))return j(W,["f",a,...m],f),w();if(i.merge)return Object.assign(A,f),w();Object.keys(A).forEach(h=>{h in f||(f[h]=null)}),Object.assign(A,f),w()});return()=>{p=!0,g(d)}})};var be=(e,i,t)=>{var r,n;let{setting:o}=i;if(!t.isTemplate||(r=t.parent)!=null&&r.isTemplate)return;let a=(n=v.variables)==null?void 0:n.find(({id:c})=>c===i.indexVariable);a&&(t.remove(),t.register(e,()=>{let c=!1,m=l(i.value,t.replacers),p=u(()=>{if(c)return;let s=m()||[];if(!Array.isArray(s)){t.clones.forEach(F=>F.destroy()),t.clones.length=0;return}let d=s.length,f=t.clones.length,w=t.clones.splice(d,f-d);w.forEach(F=>F.destroy());let A=[],h=[];s.forEach((F,N)=>{let Q=t.clones[N];if(Q){h.push(Q);return}let T=new ue(Z(t.node),t.name,t.parent,!1,[a.name,N]);B(T);let U=t.clones[N-1]||t;(U.rendered?U.node:U.anchor).after(T.rendered?T.node:T.anchor),t.clones.push(T),A.push(T)}),t.emit(o,{addedClones:A,updatedClones:h,removedClones:w}),window.Wized.emit("element",{id:e,setting:o,element:t,addedClones:A,updatedClones:h,removedClones:w})});return()=>{c=!0,g(p)}}))};var b=async(e,i,t)=>{var o,a;if(!(e.hasCondition&&!E(e.condition,i,t))){if(e.action==="set-variable"){let r=(o=v.variables)==null?void 0:o.find(({id:c})=>c===e.variable);if(!r)return;let n=E(e.value,i,t);return W.v[r.name]=n,n}if(e.action==="navigate-to"){let r=E(e.url,i,t);if(!L(r)&&!(r instanceof URL))return;let n=R(r);return n?(e.openInNewTab?window.open(n,"_blank"):window.location.href=n.toString(),n):void 0}if(e.action==="set-cookie"){let r=(a=v.cookies)==null?void 0:a.find(({id:c})=>c===e.cookie);if(!r)return;let n=E(e.value,i,t);return W.c[r.name]=n,n}if(e.action==="perform-request")return await M(e.request,i);if(e.action==="run-function")return E(e.function,i,t,!0)}};var Ce=(e,i,t)=>{let{setting:o}=i,{isTemplate:a,node:r,replacers:n}=t;if(a)return;i.event=i.event.toLowerCase();let c=i.event==="submit";t.register(e,()=>{let m=async s=>{if(window.Wized.emit("element",{id:e,element:t,setting:o,event:i.event}),i.preventDefault&&(s.preventDefault(),c&&s.stopPropagation()),await b(i,n,{e:s,t}),c&&i.resetForm&&r instanceof HTMLFormElement){r.reset();let d=r.querySelectorAll("input, select, textarea");for(let f of d)f instanceof HTMLInputElement&&f.type==="submit"||te(f,["input","change"])}};return ie(r,i.event,m)})};var he=(e,i,t)=>{var p;let{setting:o}=i,{isTemplate:a,node:r,replacers:n}=t;if(a||!(r instanceof HTMLAnchorElement))return;let c=(p=v.parameters)==null?void 0:p.find(({id:s})=>s===i.parameter);if(!c)return;let m=l(i.value,n,{t});t.register(e,()=>{let s=!1,{name:d}=c,f=u(()=>{if(s)return;let w=m();try{let A=oe(r.href);q(w)?A.searchParams.delete(d):A.searchParams.set(d,k(w));let h=R(A);if(!h)return;r.href=h.toString()}catch{}t.emit(o,{name:d,value:w}),window.Wized.emit("element",{id:e,element:t,setting:o,name:d,value:w})});return()=>{s=!0,g(f)}})};var xe=(e,i,t)=>{let{setting:o}=i,{isTemplate:a,replacers:r,node:n}=t;a||t.register(e,()=>{let c=!1,{style:m}=i,p=l(i.value,r,{t}),s=u(()=>{if(c)return;let d=p();L(d)&&(n.style[m]=d,t.emit(o,{style:m,value:d}),window.Wized.emit("element",{id:e,element:t,setting:o,style:m,value:d}))});return()=>{c=!0,g(s)}})};var ke=(e,i,t)=>{let{setting:o}=i,{isTemplate:a,replacers:r,node:n}=t;a||t.register(e,()=>{let c=!1,{type:m}=i,p=l(i.value,r,{t}),s=u(()=>{if(c)return;let d=p(),f=q(d)?"":k(d);m==="text"?n.innerText=f:m==="html"?n.innerHTML=f:m==="markdown"&&import("./marked.esm-ODZH7VPJ.js").then(async({marked:w})=>{n.innerHTML=await w.parse(f)}),t.emit(o,{value:f,type:m}),window.Wized.emit("element",{id:e,element:t,setting:o,value:f,type:m})});return()=>{c=!0,g(s)}})};var Se=(e,i,t)=>{let{setting:o}=i,{name:a,isTemplate:r,node:n,replacers:c}=t;if(r||!$(n))return;let m=c.map(([,p])=>p);t.register(e,()=>{let p=!1,s=l(i.value,c,{t}),d=u(()=>{if(p)return;let f=s();ee(f)&&(j(W,["i",a,...m],f),t.emit(o,{value:f}),window.Wized.emit("element",{id:e,element:t,setting:o,value:f}))});return()=>{p=!0,g(d)}})};var Te=(e,i,t)=>{let{setting:o}=i,{isTemplate:a,replacers:r}=t;a||t.register(e,()=>{let n=!1,c=l(i.value,r,{t}),m=u(()=>{if(n)return;let p=!!c();if(p===t.rendered)return;p?t.render():t.remove();let s=p;t.emit(o,{displayed:s}),window.Wized.emit("element",{id:e,element:t,setting:o,displayed:s})});return()=>{n=!0,g(m)}})};var qe=async e=>{var p;let{id:i,name:t,after:o,trigger:a}=e,r=(p=v.requests)==null?void 0:p.find(({id:s})=>s===e.request);if(!r)return;let n=e.hasCondition?y(e.condition):[];await z.waitFor(n);let c=e.hasCondition?l(e.condition):()=>!0;return I(()=>{var s;return(s=W.r[r.name])==null?void 0:s.hasRequested},async s=>{if(!(!s||!c())){window.Wized.emit("event",{id:i,name:t,trigger:a,type:"action"});for(let f of o||[])await b(f)}},{immediate:!0})};var Re=async e=>{let{id:i,name:t,after:o,trigger:a}=e;await P.await();let r=e.hasCondition?y(e.condition):[];await z.waitFor(r);let n=e.hasCondition?l(e.condition):()=>!0,c=u(async()=>{if(!(!x.some(({name:s})=>s===e.attribute)||!n())){window.Wized.emit("event",{id:i,name:t,trigger:a,type:"action"});for(let s of o||[])await b(s)}});return()=>g(c)};var Pe=async e=>{let{id:i,name:t,after:o,trigger:a,condition:r}=e,n=y(r);await z.waitFor(n);let c=l(r),m=u(async()=>{if(c()){window.Wized.emit("event",{id:i,name:t,trigger:a,type:"action"});for(let s of o||[])await b(s)}});return()=>g(m)};var Ve=async e=>{let{id:i,name:t,trigger:o}=e,a=e.hasCondition?y(e.condition):[];if(await z.waitFor(a),await D(),!!(e.hasCondition?E(e.condition):!0)){window.Wized.emit("event",{id:i,name:t,trigger:o,type:"action"});for(let n of e.after||[])await b(n)}};var Fe=async e=>{let{id:i,name:t,trigger:o}=e,a=e.hasCondition?y(e.condition):[];if(await z.waitFor(a),!!(e.hasCondition?E(e.condition):!0)){window.Wized.emit("event",{id:i,name:t,trigger:o,type:"action"});for(let n of e.after||[])await b(n)}};var S=new Map,Le=async()=>{Ze(),Ye(),(await P.await()).forEach(B),H()},Ye=()=>{var e;(e=v.actions)==null||e.forEach(i=>{i.type==="event"&&De(i)})},De=e=>{let i,t=async r=>{switch(r.trigger){case"condition":{i=await Pe(r);break}case"after-request":{i=await qe(r);break}case"page-loading":{await Fe(r);break}case"page-complete":{await Ve(r);break}case"attribute-present":i=await Re(r)}};t(e);let o=r=>{r.type==="event"&&(i==null||i(),i=void 0,t(r))},a=S.get(e.id)||[];a.push({update:o,cleanup:i}),S.set(e.id,a)},B=e=>{var t;let i=ge(e);(t=v.actions)==null||t.forEach(o=>{o.type==="element"&&je(o,i)})},je=(e,i)=>{let t=({id:n,actions:c,attributes:m})=>{let p=i.filter(s=>m==null?void 0:m.some(({name:d})=>d===s.name));for(let s of p)if(s.mode!=="elements"){s.mode="actions";for(let d of c||[])switch(d.setting){case"list":{be(n,d,s);break}case"on-event":{Ce(n,d,s);break}case"class":{Ee(n,d,s);break}case"visibility":{Te(n,d,s);break}case"style":{xe(n,d,s);break}case"text":{ke(n,d,s);break}case"value":{Se(n,d,s);break}case"form":{Ae(n,d,s);break}case"parameter":{he(n,d,s);break}case"attribute":{we(n,d,s);break}}H(s.node)}};t(e);let o=()=>i.forEach(n=>n.invalidate(e.id)),a=n=>{n.type==="element"&&(o(),t(n))},r=S.get(e.id)||[];r.push({update:a,cleanup:o}),S.set(e.id,r)},Ze=()=>{let{Wized:e}=window;e.on("addaction",i=>{if(i.type==="element")return je(i,x);if(i.type==="event")return De(i)}),e.on("updateaction",i=>{(S.get(i.id)||[]).forEach(({update:o})=>o(i))}),e.on("removeaction",({id:i})=>{(S.get(i)||[]).forEach(({cleanup:o})=>o==null?void 0:o()),S.delete(i)})};var Ie="2.24.0";var O=class extends le{constructor(){super(...arguments);this.version=Ie;this.config=v;this.data=W;this.elements={get:t=>x.find(o=>o.name===t),getAll:t=>x.filter(o=>!t||o.name===t)};this.requests={execute:M,waitFor:pe,getClient:fe};this.loading=new Promise(t=>{this.resolve=()=>{t(this),delete this.resolve}})}push(t){this.loading.then(t)}};var Me=()=>{let e=window.Wized;window.Wized=new O,Array.isArray(e)&&e.forEach(i=>{typeof i=="function"&&window.Wized.push(i)})},Oe=()=>{var e,i;return(i=(e=window.Wized).resolve)==null?void 0:i.call(e)};var G=new Map,Ne=()=>{var e;(e=v.requests)==null||e.forEach(J),et(),z.resolve("r")},J=e=>{let{id:i,name:t}=e,a=[["data",null],["headers",null],["isRequesting",!1],["hasRequested",!1],["statusText",null],["status",null],["ok",null]].map(([r,n])=>ae(["r",t,r],n));G.set(i,()=>{a.map(([,,r])=>r())})},et=()=>{let{Wized:e}=window;e.on("addrequest",J),e.on("updaterequest",i=>{let t=G.get(i.id);t==null||t(),J(i)}),e.on("removerequest",({id:i})=>{let t=G.get(i);t==null||t()})};var Ue=async e=>{var p;let{id:i,name:t,actions:o,trigger:a}=e,r=(p=v.requests)==null?void 0:p.find(({id:s})=>s===e.request);if(!r)return;let n=e.hasCondition?y(e.condition):[];await z.waitFor(n);let c=e.hasCondition?l(e.condition):()=>!0;return I(()=>{var s;return(s=W.r[r.name])==null?void 0:s.hasRequested},async s=>{if(!(!s||!c())){window.Wized.emit("event",{id:i,name:t,trigger:a,type:"event"});for(let f of o||[])await C(f)}},{immediate:!0})};var He=async e=>{let{id:i,name:t,actions:o,trigger:a}=e;await P.await();let r=e.hasCondition?y(e.condition):[];await z.waitFor(r);let n=e.hasCondition?l(e.condition):()=>!0,c=u(async()=>{if(!(!x.some(({name:s})=>s===e.attribute)||!n())){window.Wized.emit("event",{id:i,name:t,trigger:a,type:"event"});for(let s of o||[])await C(s)}});return()=>g(c)};var _e=async e=>{let{id:i,name:t,actions:o,trigger:a,condition:r}=e,n=y(r);await z.waitFor(n);let c=l(r),m=u(async()=>{if(c()){window.Wized.emit("event",{id:i,name:t,trigger:a,type:"event"});for(let s of o||[])await C(s)}});return()=>g(m)};var Ke=async e=>{let{id:i,name:t,trigger:o,actions:a}=e,r=e.hasCondition?y(e.condition):[];if(await z.waitFor(r),await D(),!!(e.hasCondition?E(e.condition):!0)){window.Wized.emit("event",{id:i,name:t,trigger:o,type:"event"});for(let c of a||[])await C(c)}};var Be=async e=>{let{id:i,name:t,trigger:o,actions:a}=e,r=e.hasCondition?y(e.condition):[];if(await z.waitFor(r),!!(e.hasCondition?E(e.condition):!0)){window.Wized.emit("event",{id:i,name:t,trigger:o,type:"event"});for(let c of a||[])await C(c)}};var V=new Map,Ge=async()=>{var e;tt(),(e=v.events)==null||e.forEach(Je)},Je=e=>{let i,t=async r=>{switch(r.trigger){case"condition":{i=await _e(r);break}case"after-request":{i=await Ue(r);break}case"page-loading":{await Be(r);break}case"page-complete":{await Ke(r);break}case"attribute-present":i=await He(r)}};t(e);let o=r=>{i==null||i(),i=void 0,t(r)},a=V.get(e.id)||[];a.push({update:o,cleanup:i}),V.set(e.id,a)},tt=()=>{let{Wized:e}=window;e.on("addevent",i=>{Je(i)}),e.on("updateevent",i=>{(V.get(i.id)||[]).forEach(({update:o})=>o(i))}),e.on("removeevent",({id:i})=>{(V.get(i)||[]).forEach(({cleanup:o})=>o==null?void 0:o()),V.delete(i)})};var it=async()=>{var e,i,t;Me(),Y&&(await import("./configurator-Y3NNCIS5.js")).init(),await ye(),re(),de(),ce(),me(),Ne(),(e=v.events)!=null&&e.length||(i=v.elements)!=null&&i.length||!((t=v.actions)!=null&&t.length)?(Ge(),await K(),ze()):(Le(),await K(),ve()),Oe(),v.showBranding&&X()};it();
